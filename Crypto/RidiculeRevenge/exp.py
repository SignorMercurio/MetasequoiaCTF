import gmpy2
from libnum import n2s,s2n
import binascii

#n = 21173064304574950843737446409192091844410858354407853391518219828585809575546480463980354529412530785625473800210661276075473243912578032636845746866907991400822100939309254988798139819074875464612813385347487571449985243023886473371811269444618192595245380064162413031254981146354667983890607067651694310528489568882179752700069248266341927980053359911075295668342299406306747805925686573419756406095039162847475158920069325898899318222396609393685237607183668014820188522330005608037386873926432131081161531088656666402464062741934007562757339219055643198715643442608910351994872740343566582808831066736088527333762011263273533065540484105964087424030617602336598479611569611018708530024591023015267812545697478378348866840434551477126856261767535209092047810194387033643274333303926423370062572301
#c=16396023285324039009558195962852040868243807971027796599580351414803675753933120024077886501736987010658812435904022750269541456641256887079780585729054681025921699044139927086676479128232499416835051090240458236280851063589059069181638802191717911599940897797235038838827322737207584188123709413077535201099325099110746196702421778588988049442604655243604852727791349351291721230577933794627015369213339150586418524473465234375420448340981330049205933291705601563283196409846408465061438001010141891397738066420524119638524908958331406698679544896351376594583883601612086738834989175070317781690217164773657939589691476539613343289431727103692899002758373929815089904574190511978680084831183328681104467553713888762965976896013404518316128288520016934828176674482545660323358594211794461624622116836
n=51503665135173129660519936554236985693857816865819945103090243784173339101345521522107272730482914174701760345434549979929793069711256866920851284283914220098468767009208393744120017868323165688889036357121040379341521821510675675292876081159050637204066256860631650212508491263300260604369671968517487354463694483406800300307266589028358254503993925725514867129101472938335412782160251656230879407819746672682250680064587461149688059521063210389834267849215098801629807434632775124318804428956039757841855434893107792607848373626706431832019214064807715853997371459233589540529123680628195293021461330799955632501252632812941213075423441097859897067134683524003387599733638351500055343463927911412402342175956556178644735774308477083960229449256617058548512306179993294078629298856516867279589179261
c=16495139845532898505514576573454305515638601503773511576154174617340384542514464350993741757393175502456578518261610299639612482633978297741937895361398726642005436595632166700216682463357229066807679756811764609777501420170706325574634716602220709950035144621881769019371541545015616924452239085283958796606541761609274249078733486935335508796495389773000685334173209350303881515885849322002163989083899182489041544547872199566619405347095826672764539786798149822538084651638376409863950406431371608529473380047351746461534684707741502705384925381108465431484408824479343783679842174830529374613316646631012136684671214031604182505095107768739263677342571161861724499730972908584173230709928605599670323344848550358947956305680118752813097694320230109349929639185176387969591220939055236765839171078

e = 65537

nnn1=int(str(n)[:200])-1
nnn2=int(str(n)[600:])
ab=int(str(nnn1)+str(nnn2))
#ab=2117306430457495084373744640919209184441085835440785339151821982858580957554648046398035452941253078562547380021066127607547324391257803263684574686690799140082210093930925498879813981907487546461281266736088527333762011263273533065540484105964087424030617602336598479611569611018708530024591023015267812545697478378348866840434551477126856261767535209092047810194387033643274333303926423370062572301
a2b2=n-(pow(10,400)+1)*ab #a**2+b**2
# print a2b2
t=a2b2//pow(10,200)
# print t
t1=t+2*ab #(a+b)**2
print ("(a+b)**2:",t1) #(a+b)**2
t2=t1-4*ab #(a-b)**2
print ("(a-b)**2:",t2) #(a-b)**2
tt1=gmpy2.iroot(t1,2)[0]
print ("(a+b):",tt1) #(a+b)
tt2=gmpy2.iroot(t2,2)[0]
print ("(a-b):",tt2) #(a-b)
b=(tt1-tt2)//2
a=tt1-b
print ("b:",b)
print ("a:",a)
print (gmpy2.iroot(t1,2))
print (gmpy2.iroot(t2,2))
p = a*pow(10,200)+b
q = b*pow(10,200)+a
print (p*q==n)
print ("p",p)
print ("q",q)
phin = (p - 1) * (q - 1)
d = gmpy2.invert(e, phin)
print ("d",d)
flag = gmpy2.powmod(c, d, n)
print (binascii.unhexlify(hex(flag)[2:]) ) # test